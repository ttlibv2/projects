package vn.conyeu.demo;

import com.alibaba.innodb.java.reader.TableReader;
import com.alibaba.innodb.java.reader.TableReaderImpl;
import com.alibaba.innodb.java.reader.page.AbstractPage;
import com.alibaba.innodb.java.reader.page.index.GenericRecord;
import com.alibaba.innodb.java.reader.service.StorageService;
import com.alibaba.innodb.java.reader.service.impl.FileChannelStorageServiceImpl;
import lombok.extern.slf4j.Slf4j;
import vn.conyeu.commons.utils.Objects;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.StandardOpenOption;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Iterator;
import java.util.List;
import java.util.stream.Collectors;

@Slf4j
public class MysqlDemo {

    static List<String> ALL = Arrays.asList("00233de0-9e20-4cde-976d-c80461491c72","004c0c04-02a8-4dbd-9286-002866722130","0056b751-76ec-4ed1-8550-9b2ceb288761","008233ae-4d9e-4801-ad5a-61baeb4f4603","013edfee-d796-419d-95e2-0f73f0866a2c","017b89c8-877a-4a8d-8adb-28cad3e22988","01897880-93f8-4ed6-b435-56e9a8967025","01bc53f5-2e07-4c2d-9bd9-d80c3f3a0450","01f87c65-c9a3-477f-b3fd-222d0690bc5e","021f366a-6088-43cd-93be-73e0fc7d0589","028635e1-d653-4d4c-829a-494267c4f312","02e00c9c-9e54-4aa2-80f7-17febcb46d09","03a5ae7c-9789-4628-81c9-4ba93b8aaf5f","040f5589-cb18-42f6-9de8-cc4b9a418aa4","043d3dea-416d-4fb9-9862-f393cdb79de9","0524a4f3-a38b-42fe-a332-80d5d28b076f","053e9aee-f6ba-44d0-b867-7e8f801b0bb8","05b2847c-e67c-45ad-8a7c-ef802be295ea","06568f36-f593-4d77-899e-c01c4c40f2cb","06dcf0ef-343f-4ace-a82a-643d22112678","06e3a6a4-6c9c-413b-be59-ffc8e875de68","06ef5603-59c4-4cfd-bcdb-5f98f7dc13c3","0707804b-d5cd-439c-90d1-f2c0a053136c","073b1d6c-9937-44e4-b5ba-15b1513c0684","077bdfb0-37c4-4868-826e-7718498c90ec","07adcc51-5563-4795-b7aa-7fa2f32b5b11","07b98e38-546a-4a1b-9281-73b81ea4ec2c","0835a91f-e857-400a-843e-c5abebc37b17","08bf0643-51a3-49ba-9b59-d0b5f8f13769","094ca393-9592-41bb-9ce1-eaf7be8516e7","095f08cc-23e5-4940-81fd-8c673fd096da","097b2d61-0336-48ff-93c6-a9dddb6a51f8","09c0e76f-9f8a-4891-bea5-04c2c81e6403","0a66b32e-367f-4096-a38f-c2729451c305","0ac2e786-6085-488c-8b21-15e919c84471","0ac86e9b-603f-435b-aa1b-b4eb2274f168","0b5ffea1-33ff-4471-943c-044209b58f47","0bf2eb16-3c9b-4752-b2e6-ec07ae5e987d","0c1e4418-fb99-4136-949c-b987d3111d5c","0c478679-4c38-4e09-b1d2-0b90e8ef59d9","0c860d9d-b17c-437d-a452-4cf879d2fe50","0cad9fc4-4b0c-474c-a895-223b8a4ae80f","0cdd71a2-1cc1-4526-8891-2e6cfebf0e71","0d1a2f08-662f-4ad0-b3ff-87825a54b58b","0dc3cbad-9c81-408d-94a2-3dfbc794c196","0ddf8a87-d12b-4fbd-95a4-c322f4ae32ba","0ef5c1d0-9a39-423c-b900-5af005b37e49","0f013106-00ce-4536-816f-bec9d26d0dd8","0fa2641d-8312-4f4e-9229-5e9c8743d6f4","108fc85b-8dbd-4fc2-80f7-d7d5e6b70a1c","10e5e180-f576-4f3a-bc1b-67cc8a4c9ad6","10ede073-7159-472c-9d80-749b3a7cf7b9","120bfb40-4c65-4d46-9676-d08ef020bc26","1268f215-c875-4cad-9bf3-eecfa9c9c972","126a2d07-b240-425b-9bf6-8801e5907c84","1281a9a5-cd68-482e-a33f-bbeae442f04b","12e1680a-2d8f-4e03-b63e-d703c062f1f1","135d89c7-3487-4aae-9724-f52b802ba0d6","13b67919-59ba-4011-b03d-9f731ef95027","13e200b5-2699-4af9-94f7-26333307ee60","1401d79e-246d-480e-b7d2-6358f4d24564","14bf70fa-234f-4bed-b39f-2cd68dad7c35","153577e8-c006-4d4d-aea2-d7a80f933c44","16136c63-43d8-4655-b41b-4884739aa77d","16b70bc8-f1e7-4f1d-bd7b-b9e452986026","16ccaed1-37fc-4de2-9dbd-9c7df31145fb","16d9349a-5892-4aa6-b958-7354dfeff36b","16f99ce2-ad87-4165-ba17-ce8f15aa8392","1731375a-513e-41fc-a7ee-e6a71d2e05ce","17382ecc-98d9-4b55-abce-692749bdfb66","174caec1-5b12-4cd9-a86f-8304b7d5d620","1781fe54-ee6a-407d-968f-5859d147fd52","179855ac-1732-4918-bdd4-3f1e31806994","179ba8aa-1c1a-4930-8478-b78e22aa4d8e","19a2bd71-7250-431d-b9a2-acb74d382b43","19d82ef3-8a1e-429c-b936-fffefa439f58","1a198b8e-9f77-46f3-8ed6-3961e7b4589e","1a31dd9d-af5d-42c7-b71c-30e808a566b6","1aadfeb0-f385-4dda-aa8b-ba59641a8060","1afcc8c0-fe6c-415c-ab82-18508f64afb9","1bb33065-bc80-4b00-82a5-1d7ae33f2c62","1bbdf716-e991-4942-ad17-34257a255603","1bf336d4-bebc-46dc-a60f-db1eb685f90d","1c1131a1-c7ba-4dc2-8a11-dec541ce04cd","1c5919e7-ca4c-4fb1-816d-26852a84c847","1c98da61-5b0b-49f7-80d1-40ef7c029ceb","1c9a0667-647a-4e02-bc81-452fe4c0a811","1cc0e00d-2a2e-4a85-9e8e-e4376997c138","1cd84403-22f1-4a4e-8c7f-409ab8eca2f7","1ce9aa63-4b7b-4864-910b-05c616972859","1cf02f01-57fe-4fbd-9617-b1735e1632d0","1d750fb2-db48-48a9-a996-389740a5f690","1dc6c5c1-7e10-458a-8d42-825c356136a1","1e3526a8-6b5c-4ee3-941b-5b73a0dd8a5c","1e82297e-67e9-48bc-b011-a846c7307638","1f7a306c-7e7f-4f7e-9527-5b944fa7bb06","20340bef-a79f-4ca7-8d38-3fed4d912f1c","2099da6c-69f5-49a7-b9aa-cd74104dacdc","225c7567-d2fe-46f0-9177-a1998e04ecaf","22c128c1-8bfc-4669-8c1d-91d5f2f2da89","23e34f1c-f63c-41b0-a541-4486fa923cea","245e58a9-2267-494a-a43e-9506542b5323","247511bf-d8c1-4cb1-af85-1297a272894a","25297d2d-84fc-4c3f-ac7c-0ce499407185","2541b948-a742-4b92-aa64-31d3778d3306","2576a29e-9bbf-4e98-a8f9-ed3fbea4370f","2600f93e-9033-4e23-8e5c-9e640ee1ab21","270d4c72-5f5f-498b-b89d-1e99f0b26e4f","271c5eda-1013-40ce-bc24-0361c3b438e1","275d8b95-b5d3-41c9-8fa9-f383db392bac","27cc2caa-e54f-4fa7-b51d-0f67bdc3c349","27eee925-1976-4779-93c6-f3e163735152","2a8d9761-c5fd-4207-8690-15b1d55fd2cd","2afc7207-4051-448a-af1f-f57781ab9f38","2bc75ddb-211b-4dd5-b2ae-8ab26929c396","2c50e929-8c10-475e-84d7-7df02376e1e8","2d6abdd6-dbf1-4196-9dd7-77206f6edfaf","2da4c0e6-2599-4765-813e-f7c4fa5ac873","2db22e57-7c5b-4c76-bfca-41370a71a529","2e910ebe-5357-4eb1-adce-976718c3f183","2f7cffa0-ad97-4946-9aec-e1145a532733","2f7fdb2c-8d74-4393-a9dd-a498f0cf6d31","2f9e0883-4651-4432-8c61-45bbe971e94f","305e1895-ab4e-4b22-b2bd-5dbd12e62432","30642e60-f88c-4ac8-afcc-007104b0d058","307fdc53-5741-401a-a676-a42e367e93f7","3092065e-ca45-486c-a189-deb49011ee31","3154debd-f9de-4640-89b3-bf4f5ff96952","318497b1-4cd5-4af6-aab3-2790bccad0ec","31954b6b-9a4d-4182-8329-30d1e0489062","31992ce2-5dff-44e6-a65f-cff9ce5f2df4","31ddcef0-9915-4db2-b673-d30e2b5938fb","325b035f-c72a-425a-bcd9-ec266c9f548f","32f40ad9-0b3f-4ab8-8e8b-96865c9bebfd","33019371-e936-47a6-a21e-f71e2c64cbfb","333cbc35-08dd-4534-83cc-1caa08163de3","33f146e3-35cd-4f01-8d29-78f400a4041f","34741f9f-8fad-491b-80e4-cd3d473e5631","34cfd639-cb9b-4150-a5e9-66b7de77213e","354e9801-c132-440c-a26c-bbddf596e6d5","35b61a9a-2f2f-4f48-ba27-44703e435764","35cd3e0b-e509-475b-b329-494b9e2009f2","3667b9b4-e585-41cd-a3d8-68272a85455b","36d6e2ae-e5b5-4735-a5e4-1bbbefa7e216","37164fe4-4785-4c92-ab8e-b8013fc9c280","3786ed58-aed8-45fc-abda-0e37a74faa02","378dfa3d-a359-45fb-8936-4f519c684559","3840430b-3c19-4c9b-9b41-ee84bc2af850","384263d6-5943-4bee-982f-37ecaf67a6f3","3881204e-65da-4c59-87d2-99a66bad83c9","39301160-2afe-4d2d-97fd-b3d8d459829d","3974be09-1a3a-4f8d-ab01-acd0a59f3b59","3a069787-0207-4e1f-8306-0b44ed42635a","3a4af12b-3b07-454f-8f60-ed6e1c70c11f","3a81e136-2498-460d-a913-19039ae9ade0","3a958717-1c02-499e-8c35-8357913daaac","3acc3488-8f01-4957-87e8-953880f96484","3b3b98a2-2578-4db0-8ab7-07f0c3527892","3b4c278e-9843-4f4a-be19-eb145fda9292","3c01dcd2-f10a-4a26-8521-f1b7899104cb","3c420710-063e-4cf4-9b5c-fb2988a84138","3c4cc38f-11c9-4646-9a79-43510e2ed9cc","3d27eede-94e2-4bc0-b62d-60e08b840e2b","3d7ccb18-3215-498e-8586-ea394e1c401d","3da0dc01-5b89-4b45-831f-b8402b3bc537","3e02241b-194e-4ed2-bb03-5d29c0ace8cb","3e4812d0-0745-4253-9002-e02ba8b5f491","3e97c868-d0da-4815-b22a-3a509266c3f8","3eac9b94-ee3b-43c3-9f2c-6ea60296bcef","3ee0df98-3771-42bd-a983-252ab5d40e7f","3f33e3fd-b26d-4a1d-b3d8-33bce1379385","3f353c9f-4a90-4481-ad9e-716eea2a4f2a","3f4321e0-3320-408c-9c13-491f254cce7f","400647c4-ca9e-4e5f-9080-bcfba5dc1e46","410b3307-8cb2-4eb7-a26a-9eaeaa15b58a","41313ae1-4cbd-4a78-84d3-d9b750c2e875","413e0edd-5f6a-47b7-bbb9-f44392753b48","414600f7-3ffc-4cb2-8a53-8e220d4963a9","4176c514-3d54-4fd2-aac9-c22e01cba2d8","42179b91-c92d-4480-901d-a8be98affa8e","429f8db9-88d4-467d-a615-35a2cae86295","42dc0ba4-2f55-4866-b365-e3100f48e2d5","437bd556-7558-452f-86be-ddbeb74b11da","43c21a9f-03ce-4194-9341-8df6075f0183","4410bbb7-50d0-4351-bef6-e0a0c0c02c3d","443d37e9-bab8-463c-9168-5324332d4092","448b6c43-47fe-46a9-8896-d6231bd751c0","4491d324-ce49-4a22-86eb-f969a858640a","45afe06d-bab8-44fd-aa1c-ad78453b7c8d","45ceed6c-87a8-4851-96e9-f2b3cf2dcd2d","45fc5398-33f3-49da-a770-0ae0bf73075b","462c326b-ea23-443c-9c79-a9e3473ee993","4660e1e9-557b-4b39-a240-55e2eebf5f01","46d2eef8-b5cb-4844-921f-521e241b11ee","4708f397-c1c2-426d-8315-60834fe42134","475ebdb1-f501-4a55-9b2f-b527c146cf41","48012627-fce6-46a8-a665-5f677ecc6eb5","48c5f728-a5d0-46c7-8363-fda895d67f7a","48e9d283-ecf3-4b77-bfa2-4ac443f5c7c8","4999a19c-d0ee-4f7f-864b-d85026b011ad","49afe306-21e1-46ca-bed8-9b89d03aca38","4a5d6b87-8201-4129-b4d1-6f0771e6d225","4b1d2fd0-a7cd-4cdb-8851-22e9cf06c526","4b3b9336-f8fa-48c3-99f2-991aee475e47","4bc0819a-1144-4ce6-8263-a8ab1deb1bc5","4bcdedb2-c6e1-42d5-bcd4-b7e04bacdb25","4bf6edae-3dea-4623-a11b-c72b99ebc17e","4c6340be-e682-41da-b518-f9072d3d59bd","4d819b9b-5518-4aa7-901d-875ef63d7d97","4e2dc1eb-09e2-46fb-bca4-5f63b85691d6","4ef53609-8735-4960-a174-17f16f0e0bc4","50b097ad-c727-4a11-b906-c25c3b0fe56d","5106a1a5-e14e-4171-a4ad-85f8192b3ddb","5148e40a-530f-40fe-a4ac-144cbb6e17cc","514dedf2-2684-46f5-9230-8f9984833bd5","51e8b5ee-0dcd-475f-ac6f-fcec244e53d4","52347657-5984-4c87-871e-2d9c5d292d51","5300b97c-35a1-4afc-8313-291c236c62b7","533175ae-55b7-496c-8be0-3cf61ae19c35","539ba7d3-025e-4b5d-acb5-9c343f50092e","548d0b59-de78-4441-a3b5-499f689dfe20","5493eb09-fd7e-4dde-b6d4-852cd00fbd14","54b5c649-0087-4c3c-85f3-48e363a82e14","54d22cb8-d21a-4378-b89e-b55ca0f957bf","54ddc5e4-3e98-47b9-b16d-8e4b393b647f","551b5f7e-126d-4e93-a42a-3c2621a96ade","56856860-d72f-4966-9015-c4dd2dec91ba","56e4885d-4c56-43c0-b01e-e771fe3f30c6","56f7c353-4765-448e-baaa-d8262045d89b","585d43ae-c940-4fac-adad-a71f2e552f27","58ea9069-5514-448e-a4b3-d059f6d94a5a","591702ed-f1e4-4972-a24e-814dddb2d795","5978a1c1-bb06-46af-a2c1-0a9b218cfb6c","5989012d-71fa-4ff1-ad38-d9ad24a651b0","5a916796-3977-4bfe-80db-0a4dd83773ca","5aa2d6e2-281f-4572-b11b-55f9e556da35","5ad95261-fae3-4313-af82-fd020edd0d0e","5b357045-7cba-420a-9b65-8fb683f00178","5ba01f62-c31a-46ab-95d2-b5b5dd98beb0","5c211876-8359-4821-ae2f-f301514e819a","5c71f790-62f7-4ebc-87d7-0c4e3d7aaa0b","5cae6f65-9b20-4757-8772-10a8d9ee2709","5ceee91c-25e9-4948-a3c8-e117b0f11569","5d53daeb-9fcf-4ec9-872c-d507cd59c908","5dc68d08-0941-4103-9a47-33f6b41a9eab","5e7e7299-d91d-4b85-acd1-070a8f34eb73","5ea0b13c-e91f-4ae8-8b38-0968365a4572","5eacc66f-5010-4487-8eb8-1fb8900a25f0","5f182ed0-fa3e-4bf7-a97c-59e17e7fd631","5fcd4cd9-e32b-44c7-9029-37de0992c031","603c4d46-3d6b-43d0-b15b-0611d5b2e5fa","6044046d-d3d5-4a7b-bf57-487799cd3529","6127b5f6-732f-43fd-8705-7dfe973b6070","612fb774-ad88-4e1d-a374-2e961239c121","6137c523-48fd-442d-a9e4-c6527fa084b4","618dd686-5dbb-422e-b2ef-e0495fa1e366","61cbc8b3-5a26-4aa7-98f7-1ff7889ce483","62b32dce-a118-4d98-88f4-71662898a285","62f86791-dbb5-43b1-b5ad-ba2ba3e5b44d","6365eb4a-a543-4866-8295-352799c0149b","63c8372d-b28c-41c0-98e0-a3aeb32947c2","63d884e1-55b1-4f3e-a5c3-b02635ec8a43","63e9feec-f65b-4cab-baaa-3b2d7e6381f7","63f5f1da-64fd-470b-8a0d-96f629906a0c","64729023-631b-424d-be60-a2053fe7ad6d","64a2dfd1-d1a2-4873-aac8-5035180068e4","64d0b4e8-2afe-4bc3-b25b-9338f7a3167d","654c4dd7-c5c8-451b-88d8-d248b18eabee","655edd15-e050-4eeb-b52e-adb740cd5c15","65a0f81a-e10e-4c83-8d3f-d250999047f7","668cb908-84e5-49a0-83c4-7bd05137c1f6","668d9c3e-8271-49a6-a9cc-b2105b23c11c","66e8b5da-1f60-4edc-bc88-12989db18fc3","6725da73-6d4f-4c91-8f9f-bd23ff98e459","67e59e65-7e0b-48fe-89da-e14242cddc84","685b75f0-4a1e-4cfe-8c2c-2c211a157285","68b99796-9019-43bc-bf5a-78377106095f","69029249-dc87-4d04-bbfb-e0c47e931974","695c7558-46fc-4c76-a083-092fc3d853c6","6abcab56-835f-47d5-8987-c5cb63268ac1","6aeb35bb-2f55-4319-b741-85813070cfdf","6b2588c5-88eb-4c9c-92cf-fa4dbd942205","6b745e61-f147-45b2-b98c-ffdf6b74549b","6b866b83-c96c-49f8-8a88-c3b952cf32c9","6bb4a860-b413-4546-86f9-3e4df0d71360","6bd73283-b46c-448c-b1fe-cc6a50fa812d","6c3dd9c7-1f17-4c74-844f-0e01d86fa5af","6c5191fe-f9da-484d-bb23-d04321e2a2fe","6c666785-08d6-4427-9a8b-a811caa5062f","6cafe951-df29-4c38-b082-74927bed22ca","6d0ded2b-71a6-468a-987d-afb3c3316a43","6d260c6d-d715-4b6c-ae02-1cf8ecc4bcd6","6db84377-47e4-4f53-ba59-e03bc1148eed","6dc27a8d-c817-44bf-9bcc-c29213d51dad","6e545cab-a0ef-46db-9eaf-e5778ef0a174","6e80866a-acd5-4afe-b0b3-a1635647506c","6f9a45d5-7698-451d-9287-796b3fee9e2c","6fa17041-2058-477c-b441-097ec4b820ce","7088cc7a-facd-406e-96ce-b139f6909bb2","70e82fde-a019-4159-8528-ac4d2f50b402","71d6a966-9521-464e-897e-e19921914f3a","720c67c0-5aca-4a10-8978-686c40d1b731","721f58d1-663c-4ec2-9c7d-f32e42d47811","72394955-a825-4c7f-a0a8-ca66bbfcbfc8","725ec080-af16-4e99-966f-ab98d6202e9b","72889ff9-10c1-4572-b3ee-47d605d709ed","7439aee1-85c4-44de-9515-cc00d712dc17","74722195-c79d-4051-a530-5e7cec6ba2bc","74988958-d3fb-4a98-9686-e1838e4df4db","74b15150-9aa9-4f68-a094-6322bb9e9e26","74c026e2-8b85-4413-ba4e-de969ee3db0b","74c5d3ef-9b8c-44a8-8167-48c32a0d8638","74ca212d-dbe7-41c5-99a2-1cd23aca531a","75da680b-2223-4bef-9328-bbb6950eded1","76f0d563-a0ca-475d-ac1e-ef6f388a9a72","773d1f5f-b345-4116-af1b-f302d4fa32f9","7769b9ae-0bd4-40ea-a1e6-4e257f4c44f7","78abf239-42ba-4f43-a4ea-7082245739a5","78b0ce89-5764-4dca-a344-e6edf48d587e","78e1cb0d-b708-43f0-b314-06956616e10e","7a3293bf-e68c-44b1-a26b-4f0ce3d17a97","7a71dc09-4c4a-4253-b26e-dc8726e60d2a","7ab877a8-8b2a-4232-b32c-d5d516aebe4c","7ac0d248-f610-45fd-835e-d7ffdfdf2e7b","7afa9897-d8a4-4f3e-b0f3-d017c96e10b8","7afdcf74-0fcd-4e95-8c0d-b69caede39bd","7b76f74a-cc11-47d3-a992-d32cec76f0bf","7bc07507-3367-437c-a0c8-da5020ae5f76","7bcc47da-2752-4895-9296-d414bf1e3adf","7c6c5b02-2677-4bd5-aed3-0de7767515c3","7ce71e35-c6cf-4e9d-b74d-97828c5369e0","7d053aec-e73f-4c76-8313-d0a95b895ee2","7d8f7fd3-14b7-4f6f-a3c3-3ab3e22f2a14","7de0197f-8dfd-4c58-932d-1e718aa4bad3","7e4bd814-9ff1-4c96-b1ce-5d844f9b4039","7e8f0f49-8260-4da8-bba5-2bcf3968584b","7ec7d03e-0685-4e86-949e-10c062ae28a2","7f4aae9e-b6e9-4f35-9614-345a254cc096","7fd317e0-795f-4171-a1a3-e57fbf681ab3","8078dc49-b5e0-4872-b8f0-80955c9ac577","808620f6-fa35-4cf7-8eb1-c95589a6c414","809ca6fe-c292-40ca-b58b-25ef4413767b","80a26fc5-be1e-4243-b098-295ddd2023a7","80f46f66-60f1-4d2c-b78d-addafe1883be","80f54654-688b-4e31-95ae-25cfae74b661","811cf5c1-59f8-4465-985a-952094de8534","81ccf19d-8cbc-46da-b06f-597a1b692f6a","824edce0-e452-4144-b08f-4573f14e7007","84473875-49e9-4e71-9675-d04968a1bc8e","848451b4-c3bc-4a33-ab5a-ba25f9cdce48","84d3b995-313c-4703-80c2-874e759bfed8","85e69387-1261-49b3-8120-49e096b83822","86c1665f-d37c-40d1-a58f-7de6eed0b6f4","86ce031e-420f-4079-a4f8-70b6216a0a87","878005d9-42ce-44db-8334-43a5782dbd73","881b878c-db1e-4bfb-9214-ba3265a1c65f","89ae5d45-9f50-4cba-8cec-aecd665a7ba4","89b23bee-4d78-4e79-9e87-67866c6179fd","8af14f88-c94d-4980-85c1-80be9b7491d7","8b091f0f-a19e-461d-b3f6-dd9441218e49","8b7b9b07-9fea-449a-93b9-12c35ec59b4c","8bccd692-0d1a-423e-9677-398b9699da7a","8ca92536-56bc-46c3-ab2a-6d31e247616e","8cb37d16-aecf-435d-8d9f-30590a9e16d3","8d68ada3-422a-4ce4-9f25-21f3f596a8a1","8d88e48d-f08c-451d-837c-087f7adf5719","8dacb159-e036-431d-aaca-bc8b98df088c","8dbcada0-e1af-48b5-8f0c-d13a677d497c","8de767d0-33a9-494b-a6be-5330fa430ef7","8e2af194-10d3-4986-a941-25c75043344a","8e386409-cf94-44af-a39c-171758a6abbc","8e83d8d5-de64-4faf-b72f-10cbcea954ae","8f32e987-46ac-4c90-ad93-c472de6105bd","9042ce00-6502-423e-a568-227b74fbc381","9093327d-9650-42ec-97e3-9cd89704ef3c","90c0a78f-a15e-4939-95b6-918cba8fd7a0","91c6b44a-d310-4fa8-aa89-2100452f9bb2","91cdd454-b2c6-4fd4-8a30-fecb82e56c76","91f220e9-0b13-43de-9a34-646526448ba3","923568ff-0d8d-4015-a770-9998570d4324","925f4e59-b348-4b64-bb9c-9d0a7a72a900","92644c63-c9cb-4248-aff1-a58d044117ce","929bc955-6453-483e-a121-be999800ae11","93159439-2e08-4cee-9afb-08b6828a1e34","936cbb10-93d9-45de-9247-205c566780a7","93b533ea-3d22-475b-84de-18f2ce9e5863","93f282ca-2abb-4881-8cd5-a95d8a4daa43","94694341-9c5a-49f3-a0b0-9eeea56ff652","95107ade-84e6-407b-bd42-897b07f00dd6","95a8ccfe-7eca-4075-827a-ea5f3ea2855c","95aeed7d-34e6-4712-9179-5ea3c1bf17e5","95c68958-67fd-4f4e-8386-f6784ba9c2ca","963b3cfc-18a2-4f2b-a7a5-a5c320b0a210","9659d2fe-b96e-44c3-acbd-7a5b7b0bffae","965a9d55-8bcc-4f05-9d1b-9d7c0ca8c71e","96609d6b-202e-4245-a25c-0505ede6bd99","9662255a-15ec-416c-9e30-6a2675554682","9680c45f-20c8-4cda-817c-e1416e547b5a","96854ca9-a9e9-4093-8934-70db3e407344","9725f165-01d0-4201-bdd9-fe9580174b35","9856da6a-2e68-4b83-a6b8-4c9faa3f14de","98fb1599-67f8-480e-a6ab-d48b3fa5ec77","98fda349-2a4b-41c8-a148-e7aefebd0b4b","99110fc0-1539-4c3f-8a46-f4865c056fb1","993f4ae7-02c4-4f7a-b54e-151d5486d49c","995ebf4a-b392-402f-a28f-d13e47598e40","996777a3-3bc3-4b21-87e9-50cb1986902f","99f1a654-c5e1-44ee-9ad9-8a761034e3ff","9a05359e-dd19-415e-8571-55273569c454","9a515866-19a9-42a9-bbf4-9ddcdd857198","9aaf9683-9e09-4210-8da3-7b4954b120bc","9acaadd0-64d8-40ed-947d-e8366a7abe4e","9ae47503-99e9-4fde-af66-0bd4689276e3","9b458105-c1ed-4635-858e-4f78d65d794d","9b754d32-5751-4111-9783-1803933e7027","9bf13854-27b7-4e67-b6d3-8bd1a8fe2edf","9cbc60c5-2996-41e3-85a1-3c36e840eec5","9cef4f62-6cab-4208-8eef-f61d87534aa1","9d36a7c0-cc23-4dc1-9cfd-cfdcb205d36d","9dd39c89-e343-4b7f-85d2-59304193561a","9e740121-2734-45aa-b770-fd0e4e5a4e22","9ed393e8-437e-4a1e-b06e-b480ed324d4d","9f0e168b-59ca-44be-a30f-7af8560dea7f","9f0f40d0-1b05-44a8-a606-b8227abdda43","a0b9326d-8a60-4daf-a87c-5340afaae6fd","a12ddaaf-21e4-435c-b4e8-7de2af2c53dd","a1ede02a-5292-4bc8-a962-d8fd58301fdf","a23ef007-60be-454e-98a6-80c514e00003","a27c48cf-acc8-4e05-b733-5f839df28879","a2a3ba02-ffa2-42cf-8e2a-598b64d09f0f","a34cc973-0cc1-4218-9458-f5c9c838639c","a4218420-8fd4-4a89-bc86-8faa29163fad","a4b44245-6cc5-4c4f-a296-fd77bed9b520","a5110c94-9d8e-4bb2-b5d1-051287875a8a","a51aa1de-252c-410e-beb9-e5f74ec27081","a5275f0c-2210-4d94-90d3-a517ffbf0d24","a54642b5-9557-43c0-93fa-74fab4d869a0","a615be02-4ae3-490e-87fe-a065d2879e1d","a6312356-66c9-4bc7-a66a-417f3e7400b8","a667a65b-4124-4477-9002-b7106ac500df","a6f690b6-df18-4838-a1c1-2bf04810e5de","a7319064-1f63-4eae-a24e-66c30a0b1e88","a78c9c04-c476-4f94-b17a-14d42e0d22ea","a83b79d1-212f-472b-9b4a-8f7cbfecaed9","a99460fd-2fb3-4c54-9fc4-40802efc05b4","a9ab8a3a-7a6b-4850-9d6b-2ff1ed9c72a1","aa0022c0-05a1-4ad4-b949-b2877f5b66a2","aa6405ad-42e0-45e3-8e24-60b38215ce3f","aae015b3-a4c6-46a8-aeb4-75252c8683b0","aae474be-10db-4349-bc1f-1c06722dd5e8","aae87a93-1d57-4100-a905-fe4bf9721f6d","ab42cf8b-382c-4593-83fe-22a5839ea750","ab5a8450-f06f-4e19-b30d-ed30fa593fc3","ac3bb4bd-d60a-4948-bcf8-ae8969f156e0","ac4cbdbd-2f97-4998-9a45-1de604a8b2fb","ac768f5c-b4d0-4295-a9ee-32e6671aad38","ac9085e1-29e6-4053-bf8d-5c120f2e1fe4","aca73ba8-9098-45de-9db8-caa18d2da8ee","ad221f2a-bae5-4e03-b731-ba140b51b24e","ad3bc973-df77-4e3b-bfcd-c7aad3cba1b5","ad9a1227-f3f7-4292-bfa4-1eef6d37dd1f","adf2eadd-9b26-4349-b891-476d291eb425","ae2eb9cc-6dae-40fd-b5ab-73435e68d318","ae62f417-5009-456e-be07-746ff5ccc39e","ae6948ca-5d0b-4fca-8a6a-f577073e5f78","ae8116b0-78a4-4191-a076-76e4fd0b31f2","ae8742e3-1a98-4b3c-bf08-0e9acc08de9c","aef6c1f6-135b-4fba-8d8f-50168e08736b","aeff8403-6d95-4a0b-8ce4-d1db153431de","afa73523-f18f-4977-944d-ecfbad20808f","b054dfca-b6e9-4371-8d69-9a3a2d1884b6","b133646b-b33a-457e-8d75-f60857b00262","b1a36a08-0932-43c8-bb6a-2911fc1fbf1f","b2e34bb2-c350-4be8-892b-c4ac348d54b5","b2e8db13-130d-4818-a14a-8816f0350145","b39d7794-2e1a-4106-9c64-6ca48e85e1c9","b3be2c85-89cd-4cfd-bad8-eaa274b64c3f","b434c98d-aec3-4c50-bc0f-b0c8b89a27f0","b4bb1fe8-e036-4a05-9359-4526232bb7fa","b500f1c0-f64f-4cc5-9975-b62c10c3309f","b55e5c12-5423-4ce5-ab19-dfa2bb16e4f7","b5612615-2477-4f8e-9991-a1d54de6fff2","b5bb44e9-c1cc-44f5-88b4-cdef942766e5","b5d566c2-1859-437f-bc42-22694535c038","b5edc1d2-0c9f-4af5-a3b2-869721481767","b61fbc73-2540-40e8-82bb-a21a1170b672","b65bccea-f1b8-47b1-9206-9a2eac2c1660","b66a2467-2e79-4743-80a1-54a925b4bcc0","b6d9d5c6-1f32-4e2a-9201-52152fa2ef48","b756e904-7eb9-4475-bf36-1b59ee9d9184","b7741244-e080-49de-a86f-e32ca5accf31","b795cd64-3c87-4def-bc09-f0a0f18d7cb5","b8160a4b-d48d-4dda-a7fb-5e7e59023639","b84dae0b-b088-4e82-8841-71a2ba556e59","b87a5999-4693-4c88-9146-32ca3c0c03b6","b984f325-b990-4d4a-b985-b25cd3d622fb","b98a3271-82d3-44ad-9bca-bb91bff43415","ba843590-c1be-4e60-a838-77fe2de058ba","bb053587-4ea3-4fa3-9605-a165a924cacc","bb08b8ec-a325-4744-b9b6-a5b504a35055","bb2aa3a1-57bb-4240-823d-c7fefba887e0","bb5a9c72-a8f6-49ff-a10f-b580832ac014","bbdf7681-01ed-4531-8194-ea1018b4650b","bc09ca5e-1670-47d6-90c8-75fcdc9c9e7e","bc245ebd-4ca3-437c-a33f-0d7098f122c9","bc7de559-9671-4b34-ab39-bd9818417cb6","bc934353-1a70-451f-b07a-73bc699a3445","bc97e41b-83bc-4fec-b394-128c66f421fd","bcb26964-0881-432a-a91c-276f293c87a4","bcf68a35-025b-40d6-a6bf-3caf2264bcb3","bd506508-7f04-4bbc-95e2-337df3652d3a","bd76e9df-e290-48b4-8524-c0e8f4d67dce","bd936a01-f5a9-4006-a575-78ff3777c4b3","bd979f3a-38bc-4746-87aa-644684a7e52f","be36cd38-1fc4-4a70-bd48-a4fec6998e5d","be9da4f4-01f9-4fc4-91f6-35c7c8199023","bf23c178-a64e-40c6-80a1-e991c36e54a9","bfdcc6cf-ce31-433b-8379-66adc9e433af","c066f1b6-3078-440c-95e0-72f2a529ac14","c09e2815-06de-4912-9b99-18ebd06e243b","c1889a7c-5a7c-4616-8203-5044e872c420","c1c16612-79cc-4bf7-af22-6b60d5579c92","c21564d7-22f2-408c-8b6d-bacec9028ffc","c2abe926-e64a-4642-bda2-fda55e39f134","c2bb0ff6-656f-4305-ae6a-15068aa4cc55","c38dfe08-d35c-4606-a49f-eddd1b44552c","c4069dac-c1bb-4ff1-ae33-0f8cb3f9e1c3","c4a72464-98fe-4eda-85e4-db10a90208a1","c4e2b86d-031d-4a8e-b20f-98815196ccc8","c4f7aadf-3d4b-4d7c-8fe5-02b55f685540","c520190a-f158-474e-9b67-b17933c30864","c522c01c-2b9f-456c-9e74-43a2a5eefbbc","c52a8dad-f670-46e8-a354-2c019b0b0290","c5c4abab-864d-457d-8d8a-ec02fef48bca","c5d86fbd-cf9a-422b-8187-bdafcc065a3a","c5e103d6-0496-4588-9ffd-db2ce8c617aa","c61246fc-9889-4cf9-bddb-5914d8051db3","c671204e-fb57-496f-81e3-e5e06ef55fb9","c6d73c21-9d0a-4cf7-bc51-875f9502900a","c7987795-a7e1-4809-8c5d-5408e443cff7","c7e511ab-db2c-4c00-9175-1c53d3c5ac31","c83f19ce-d787-4188-8ccd-28ddd1c9b17c","c8621351-4da9-4362-a0ac-e4087ef3168b","c8d72e41-fae4-4271-8793-7810d8905538","c8d92912-01f3-4b43-98b1-1705f753dff5","c91427c5-24a8-42c9-a149-82f20d4a51a5","c984fa9d-f46f-49af-9be9-56ebbf821899","ca50b577-98e0-49e7-af79-7aa70ca7168d","cb13bd9e-db83-4d41-8957-90984e7c01ba","cb50ee91-a053-49d2-a8b1-748b21be7da5","cbc6bfcd-c1b2-4391-ad5b-eaf3f04fc274","cbdc4ee1-7479-44ce-9066-a7c76292994b","cc787cc2-d0b4-4300-9116-407d76bc4723","cc8940fa-459d-4981-b754-a01e0d819bec","cca6e2fa-6d7e-4bc1-bc31-6c164ba54f8e","cce154d6-60b2-4042-ae4c-b87e16ff3fe5","ccf7c699-847e-4abf-927e-f39788a740ef","cdd864e1-c305-4409-86ba-17caf5e44708","cdf3c488-4650-4275-af9a-cb070702988a","cdfd10a5-d195-49db-8df7-c20c17acee4a","ce10c128-8492-47bf-97c9-3f8a38cfad78","ce8b5707-ec32-4f62-9360-99451aafbc3a","cee95f24-9b18-4a22-b799-447cd00f27e6","ceed73b6-b77f-4d47-8cb9-a0285e8b16ca","cf2b6a65-ad9c-42f8-ac7f-68fa5b08b826","d07d8a02-0e00-4c02-a092-5cfbc2b1486c","d0873876-7110-465d-8e32-d52dde5aa5bb","d104ee43-ef33-45ed-a4eb-6792abce86aa","d129dc3d-b7bf-45f9-a7f9-f6c4fca70549","d152425b-a750-4f28-8fc3-5915b07c1e10","d15a168a-b3af-4641-b68c-56f5e1bd5636","d1cdce70-9fed-4621-884a-0f3c3b03d08e","d1d7365a-8fc8-419f-8072-2f83faea0f4c","d21e03be-28cd-4f86-9e5a-d3bf91381f74","d2345ffe-42ba-4ed0-8916-e8e857c95414","d316fa70-1830-45f5-9087-04adc9d9e871","d36046ac-f769-44a8-a66e-5f647c439ba4","d3ebaf5d-7675-4e0a-a848-24d271fc7be8","d4194d87-566f-4a74-a09a-c66764fc0012","d49ff93b-41a1-4a94-a142-175ad1ace5ca","d5602afb-953d-4921-ae6d-97a1174da4fc","d5f81cf0-2925-477b-bbf2-5690964f2c42","d65d140f-3f3b-4294-95e6-0f6e06ee30be","d7e4ab80-ee97-43fe-a17a-e8704e1a22c6","d883b7f5-a489-43b7-9b5f-3ff9f62fb12e","d8c8b032-24c3-40c6-8685-f1ef706d97b6","d8d1cb14-5fc6-4a2c-a1a0-69c752de9020","d92a0f31-6ad3-4912-bed2-013fcffd8127","d9eca203-3e89-45ca-bae8-5d9e0bd1c7c4","da7345b6-eee8-41cf-a20d-7bf545d3153f","da80e46f-e5c3-4f66-809d-192a6a7498c2","dabfbecb-679e-49d9-a5fe-a01b4494a130","db10d862-0245-4bcf-8369-2888063d746a","db126a26-5780-4c79-b4f4-cc793ab8c6ce","dbaa8a58-158a-48a1-8ffe-1c47c9e0ebbf","dbfa7528-5d0f-45d1-8660-eb54996b20d8","dc9ca98c-81eb-4a0f-a9a0-32eb67fdf9ee","dd027c75-f51c-46f0-9fef-747004234b60","de586034-4d2f-4e05-b1d9-7096243792d1","dfa90d19-02a0-4a67-b852-d37edcdc7060","dfb8dd0e-5d10-4733-9460-33708a77567e","e0389623-10c1-4e51-b92f-c94af0d93101","e09f0c04-7535-40f1-b5fb-018a1c47a695","e0a7e28c-2891-43bd-b39d-70b240778fb8","e156379d-cbd7-4d29-bad6-a4be80a49787","e1cdb020-42a3-49b5-bc2a-81ae4cc2b777","e1f4c83f-0016-42de-9c43-03fc0e52742a","e2cbb664-912e-4ef6-8efc-12ed6dab5e0c","e3dee5f7-5c5d-4a51-a6fc-7bed0c3bf8ab","e48d3a0c-2b30-4f10-8247-e7251e2523eb","e55b84f6-aa1c-46e8-aaae-577a0b3e80af","e5d93269-a3e9-40cb-ae61-c82502343059","e61cef10-b6e2-42d3-b80a-1d52bfc905dc","e65cb559-031a-464e-a1ca-b7d63c08a9e7","e6a2d0e8-ab75-4b91-8677-7a4218254ac0","e6a48fd3-ec1c-4006-b892-888e8ec2c819","e6c287e5-bf6a-4861-a5d4-2c0345880969","e6f1d9ac-08ca-4a35-a5b2-347e2abe88d4","e78e2173-ebd5-432a-b7b5-e718bf31c8bd","e8c28e49-a149-4cb6-89e5-47e24e58841e","e8fe431d-20fa-4b7c-bbc1-ae8d349e319d","e96ebb1f-bd9c-4247-9309-561b969612f0","e9dd29b1-ab73-4612-a557-41f46748b57e","ea5e5f24-98a8-410f-a83b-ab303275b50e","eb8d8a33-0a49-4e82-b4dd-cc285f82f62a","efcf7fdb-62bb-41eb-a80f-f562f842e77a","efe21aca-e0f9-438f-9b96-2f4828f5da61","efe6ab72-df53-447c-9757-3ff9532587ed","f02523f2-7ae3-4eba-867f-ea7db015bab8","f033a67d-6691-4986-8a6e-17f1fb5dafd7","f185b651-7a82-47f8-a004-0add6852543e","f23047d0-6c3c-4ee2-a917-975088e58539","f2b8777d-9cd7-4def-a769-450f9ce2633e","f384454e-9c93-4cfe-84d2-aca72435eba2","f48bd672-6382-461b-84c2-3776c77cfb9e","f4c7c590-d05f-4258-af7d-fa56604c9503","f512cc4a-d71b-41b6-8eee-ed5385273d1d","f52d5efb-3eab-4b38-ada0-5ccdb9630bae","f5690fb9-f46a-4e02-8b94-455dbc42c597","f5a10049-8026-4c98-a271-8930d6712c32","f5fd25b2-9f45-4dee-a9a1-9de6c7654630","f6eb7920-7e39-4f9d-9444-5fae476b139f","f737c2aa-8604-421b-ba5b-f831a4daf0b7","f7d89b3d-8910-432e-a57e-f25ca1731536","f817d5b6-e767-41af-b16c-045a3491b320","f81bb760-a394-43d7-8183-528cc444ab9a","f8ab0da4-8908-4aa5-8c7c-153651e3baa8","f8b18c4e-78c7-4cb9-9f43-f8466702a672","f8fc7d41-836f-419e-9fcd-5c5a7faea4dc","f9b3cfd1-bf16-4580-b3db-de5f232c6123","f9e4de3b-2d6e-4e7f-9a58-5047f834195e","fa00d9a2-b012-442c-8bb9-69f3f4e41847","fa3d222c-25a4-4695-9d37-472af99987ff","fa6adca7-e38e-4630-96dc-08d186830b29","faa84d5d-7091-491f-ae94-a32f5626cc88","faeec46f-f8f0-4967-a361-3c10a6e05e7b","fb326260-c3dd-45a5-827e-933115b02d2e","fb608afb-bb62-4c1c-abeb-6ed1a19a5ceb","fccb6a34-2c4b-42e9-b5da-966a1233daa2","fd02e3b3-15a8-4bb3-afae-ef5435149af3","fd233227-2d8b-4c5a-ae72-c98691a016dc","fd3c4075-6f6c-4731-92be-88a709183f2e","fd455b92-f725-4751-9315-dff3a5f69f60","fd867e4e-67d2-45fd-837d-7cda443f4cc3","fdcac833-c2b2-4b8b-9fbb-e9623c931886","fdf80a9b-aaf6-4e23-a780-70e2defecd82","fea054b0-e113-45a5-a912-664e858e6717","ff1b3dc9-1a71-48fe-9ff7-0b9683b4b0b5","ff343e2a-ca80-461b-994a-bb4ad2482017","ff671f36-2536-44ab-a61c-5181bb7ad8b6","ffff66d6-1b05-48a3-859d-26f8903441ed");

    public static void main(String[] args) throws IOException {
        String ibdFilePath = "C:\\Users\\tuannq\\Downloads\\Programs\\data\\ts24pro\\chitiethoadon.MYI";
        try (TableReader reader = new TableReaderImpl(ibdFilePath, "CREATE TABLE `chitiethoadon`  (\n" +
                "  `ID` varchar(50)'',\n" +
                "  `MaHoaDon` varchar(50) ,\n" +
                "  `MaHang` varchar(50) ,\n" +
                "  `TenHang` varchar(1000) ,\n" +
                "  `DonViTinh` varchar(20) ,\n" +
                "  `SoLuong` varchar(21) ,\n" +
                "  `DonGia` varchar(21) ,\n" +
                "  `DonGiaGoc` varchar(21) ,\n" +
                "  `ThanhTien` varchar(21) ,\n" +
                "  `TenNhanHieu` varchar(255) ,\n" +
                "  `MaSo` varchar(50) ,\n" +
                "  `ThucXuat` varchar(21) ,\n" +
                "  `ThucNhap` varchar(21) ,\n" +
                "  `ThueSuat` varchar(21) ,\n" +
                "  `TienThue` varchar(21) ,\n" +
                "  `TongTien` varchar(21) ,\n" +
                "  `GUID_CHUNGTU` varchar(50) ,\n" +
                "  `TENCHUNGTU` varchar(50) ,\n" +
                "  `GUID_CONGTY` varchar(50) ,\n" +
                "  `KHUYENMAI` tinyint(1),\n" +
                "  `GHICHU` varchar(255) ,\n" +
                "  `LOAIDIEUCHINH` varchar(20) ,\n" +
                "  `TYLEBH` varchar(10) ,\n" +
                "  `BAOHIEMTRA` varchar(21) ,\n" +
                "  `MUCBHTRA` varchar(21) ,\n" +
                "  `TYLETHUETTDB` varchar(10) ,\n" +
                "  `SOTHUTU` varchar(10) ,\n" +
                "  `IDSTT` int(11) ,\n" +
                "  `KHONGHIENTHI` tinyint(1) ,\n" +
                "  `TKNO1` varchar(100) ,\n" +
                "  `TKCO1` varchar(100) ,\n" +
                "  `TKNO2` varchar(100) ,\n" +
                "  `TKCO2` varchar(100) ,\n" +
                "  `TKNO3` varchar(100) ,\n" +
                "  `TKCO3` varchar(100) ,\n" +
                "  `TKNO4` varchar(100) ,\n" +
                "  `TKCO4` varchar(100) ,\n" +
                "  `TKNO5` varchar(100) ,\n" +
                "  `TKCO5` varchar(100) ,\n" +
                "  `THANHTIENVND` varchar(20) ,\n" +
                "  `TIENTHUEVND` varchar(20) ,\n" +
                "  `TONGTIENVND` varchar(20) ,\n" +
                "  `DONGIAVND` varchar(20) ,\n" +
                "  `MIENGIAM` varchar(20) ,\n" +
                "  `BENHNHANTHANHTOAN` varchar(20) ,\n" +
                "  `CHIDINH_ID` varchar(255) \n" +
                ") ENGINE = InnoDB")) {
            reader.open();

//            log.warn("{}", reader.getTableDef());

            List<String> names = reader.getTableDef().getColumnNames();
            System.out.println(names);

            Iterator<GenericRecord> iterator = reader.getQueryAllIterator();

           // Path file = Paths.get("C:\\Users\\tuannq\\Downloads\\Programs\\data").resolve("hoadon.txt");
           // Files.writeString(file, String.join("\t", names), StandardOpenOption.APPEND);


            int count = 0;
            while (iterator.hasNext()) {
                GenericRecord record = iterator.next();
                String MaHoaDon = record.get("MaHoaDon").toString();
                if(ALL.contains(MaHoaDon)) {

                    StringBuilder sb = new StringBuilder();
                    for(String name: names) {
                        Object value = record.get(name);
                        sb.append(value == null ? "" : value.toString()).append("\t");
                    }

                    System.out.println(sb.toString());
                }
                count++;
            }
            System.out.println(count);

        }
    }
}